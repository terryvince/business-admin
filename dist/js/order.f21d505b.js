(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"634a":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order"},[i("el-form",{staticClass:"flex-main-start flex-wrap",attrs:{inline:!0,"label-position":"left",model:t.form,size:"mini"}},[i("el-form-item",[i("el-input",{attrs:{placeholder:"商品名称"},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}})],1),i("el-form-item",[i("el-select",{attrs:{placeholder:"请选择商品类型"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[i("el-option",{attrs:{label:"物流商品",value:"ship"}}),i("el-option",{attrs:{label:"核销商品",value:"code"}})],1)],1),i("el-form-item",[i("el-input",{attrs:{placeholder:"订单号/手机号/昵称/姓名"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),i("el-form-item",[i("el-select",{attrs:{placeholder:"订单状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.orderStatus,(function(t){return i("el-option",{key:t.type,attrs:{value:t.type,label:t.name}})})),1)],1),i("el-form-item",[i("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.form.timeRange,callback:function(e){t.$set(t.form,"timeRange",e)},expression:"form.timeRange"}})],1),i("el-form-item",[i("el-button",{staticClass:"left-20",attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("搜索")]),i("el-button",{staticClass:"left-20",attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("导出到Excel")])],1)],1),i("el-divider",{attrs:{direction:"horizontal"}}),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[i("el-table-column",{attrs:{label:"序号",width:"50px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.$index+1))])]}}])}),i("el-table-column",{attrs:{prop:"t_tid",label:"订单号",width:"200px"}}),i("el-table-column",{attrs:{prop:"to_title",label:"订单商品",width:"180px"}}),i("el-table-column",{attrs:{prop:"goods_type_txt",label:"商品类型",width:"90"}}),i("el-table-column",{attrs:{label:"商品数量/核销码",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("span",[i("p",[t._v("核销剩余:"+t._s(e.row.ticket_valid))]),i("p",[t._v("已被核销:"+t._s(e.row.ticket_used))]),i("p",[t._v("商品数量:"+t._s(e.row.to_num))])])])]}}])}),i("el-table-column",{attrs:{prop:"g_seller_price",label:"结算价",width:"100"}}),i("el-table-column",{attrs:{label:"收货信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("p",[t._v("昵称: "+t._s(e.row.t_buyer_nick))]),i("p",[t._v("电话: "+t._s(e.row.t_phone_ext))]),i("p",[t._v(" 地址: "+t._s("code"==e.row.g_verify_type?"无需地址":e.row.t_address_ext)+" ")])])]}}])}),i("el-table-column",{attrs:{prop:"t_note",label:"备注"}}),i("el-table-column",{attrs:{prop:"t_pay_time",label:"支付时间"}}),i("el-table-column",{attrs:{prop:"t_status_txt",label:"状态"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",["ship"==e.row.g_verify_type&&3==e.row.t_status?i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.getShipping(e.row.t_tid)}}},[t._v("发货")]):t._e(),"ship"==e.row.g_verify_type&&4==e.row.t_status?i("el-link",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(i){return t.showEditDialog(e.row)}}},[t._v("修改收货信息")]):t._e(),"ship"==e.row.g_verify_type&&4==e.row.t_status?i("el-link",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(i){return t.showShipping(e.row)}}},[t._v("查看物流信息")]):t._e()],1)]}}])})],1),i("div",{staticClass:"block top-20"},[i("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[10,20,50],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1),i("el-dialog",{attrs:{title:"发货",visible:t.shipping_dialog,width:"30%",center:""},on:{"update:visible":function(e){t.shipping_dialog=e}}},[i("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"物流公司"}},[i("el-select",{attrs:{placeholder:"物流公司"},model:{value:t.dialogForm.company,callback:function(e){t.$set(t.dialogForm,"company",e)},expression:"dialogForm.company"}},t._l(t.shipping,(function(t,e){return i("el-option",{key:e,attrs:{value:t}})})),1)],1),i("el-form-item",{attrs:{label:"物流单号",prop:"code"}},[i("el-input",{attrs:{placeholder:"物流单号"},model:{value:t.dialogForm.code,callback:function(e){t.$set(t.dialogForm,"code",e)},expression:"dialogForm.code"}})],1),i("el-form-item",{attrs:{label:"备注信息",prop:"expressNote"}},[i("el-input",{attrs:{placeholder:"备注信息"},model:{value:t.dialogForm.expressNote,callback:function(e){t.$set(t.dialogForm,"expressNote",e)},expression:"dialogForm.expressNote"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.shipping_dialog=!1}}},[t._v("关闭")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitShipping()}}},[t._v("确认发货")])],1)],1),i("el-dialog",{attrs:{title:"修改收货信息",visible:t.edit_dialog,width:"30%",center:""},on:{"update:visible":function(e){t.edit_dialog=e}}},[i("el-form",{ref:"dialog_address",attrs:{model:t.dialog_address,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"收货地址",prop:"address"}},[i("el-input",{attrs:{placeholder:"收货地址"},model:{value:t.dialog_address.address,callback:function(e){t.$set(t.dialog_address,"address",e)},expression:"dialog_address.address"}})],1),i("el-form-item",{attrs:{label:"电话",prop:"phone"}},[i("el-input",{attrs:{placeholder:"电话"},model:{value:t.dialog_address.phone,callback:function(e){t.$set(t.dialog_address,"phone",e)},expression:"dialog_address.phone"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.edit_dialog=!1}}},[t._v("关闭")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.changeReceive()}}},[t._v("确认修改")])],1)],1),i("el-dialog",{attrs:{title:"物流信息",visible:t.shipping_detail_dialog,width:"30%",center:""},on:{"update:visible":function(e){t.shipping_detail_dialog=e}}},[i("el-form",{attrs:{"label-width":"120px"}},[i("el-form-item",{attrs:{label:"物流公司："}},[i("span",[t._v(t._s(t.shipping_detail.company))])]),i("el-form-item",{attrs:{label:"物流单号："}},[i("span",[t._v(t._s(t.shipping_detail.shipping_no))])]),i("el-form-item",{attrs:{label:"发货时间："}},[i("span",[t._v(t._s(t.shipping_detail.express_time))])]),i("el-form-item",{attrs:{label:"发货备注："}},[i("span",[t._v(t._s(t.shipping_detail.express_note))])])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.shipping_detail_dialog=!1}}},[t._v("关闭")])],1)],1)],1)},o=[],s=(i("99af"),i("d81d"),i("c7e8")),l=i("9fda"),r=[{type:"wait_send",name:"待发货"},{type:"wait_use",name:"待核销"},{type:"send",name:"已发货"},{type:"confirm",name:"已收货"},{type:"complete",name:"已完成"}],n={name:"order",data:function(){return{form:{keyword:"",type:"",timeRange:"",status:"",phone:""},total:0,page:1,size:10,list:[],orderStatus:r,shipping_dialog:!1,shipping_detail_dialog:!1,shipping_detail:{company:"",shipping_no:"",express_time:"",express_note:""},edit_dialog:!1,shipping:[],dialogForm:{code:"",company:"",tid:"",express:"",expressNote:""},dialog_address:{address:"",phone:""},publicPath:"/"}},created:function(){this.getList()},components:{},methods:{onSubmit:function(){this.getList()},handleSizeChange:function(t){this.page=1,this.size=t,this.getList()},handleCurrentChange:function(t){this.page=t,this.getList()},exportExcel:function(){var t=this,e=[];this.$store.commit("updateLoading",!0,"excel导出中..."),Object(s["g"])(1,2e3,this.form).then((function(i){var a=i.data;if(200!==a.ec)return t.$message.error(a.em),t.$store.commit("updateLoading",!1),!1;e=a.data.list;var o=["订单号","订单商品","商品类型","商品数量/核销码","结算价","收货信息","备注","支付时间","状态"],s=t.formatJson(e);console.log(l["a"]),Object(l["a"])({header:o,data:s,filename:+new Date+t.$route.meta.title,autoWidth:!0,bookType:"xlsx"}),t.$store.commit("updateLoading",!1)}))},formatJson:function(t){return t.map((function(t){var e=[];return e.push(t.t_tid),e.push(t.to_title),e.push(t.goods_type_txt),e.push("核销剩余：".concat(t.ticket_valid,"\n已被核销：").concat(t.ticket_used,"\n商品数量：").concat(t.to_num)),e.push(t.g_seller_price),e.push("昵称：".concat(t.t_buyer_nick,"\n电话：").concat(t.t_phone_ext,"\n地址：").concat(t.t_address_ext)),e.push(t.t_note),e.push(t.t_pay_time),e.push(t.t_status_txt),e}))},getList:function(){var t=this;Object(s["g"])(this.page,this.size,this.form).then((function(e){var i=e.data;if(200!==i.ec)return t.$message.error(i.em),!1;t.list=i.data.list,t.total=i.data.count}))},getShipping:function(t){var e=this;this.dialogForm={code:"",company:"",tid:"",express:"",expressNote:""},this.dialogForm.tid=t,0==this.shipping.length&&Object(s["i"])().then((function(t){var i=t.data;if(200!==i.ec)return e.$message.error(i.em),!1;e.shipping=i.data})),this.shipping_dialog=!0},submitShipping:function(){var t=this;for(var e in this.shipping)if(this.shipping[e]==this.dialogForm.company){this.dialogForm.express=e;break}Object(s["c"])(this.dialogForm).then((function(e){var i=e.data;if(200!==i.ec)return t.$message.error(i.em),!1;t.getList(),t.shipping_dialog=!1}))},showEditDialog:function(t){this.dialog_address.id=t.t_id,this.dialog_address.address=t.t_address_ext,this.dialog_address.phone=t.t_phone_ext,this.edit_dialog=!0},changeReceive:function(){var t=this;this.$confirm("确定要修改吗",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])(t.dialog_address).then((function(e){var i=e.data;if(200!==i.ec)return t.$message.error(i.em),!1;t.edit_dialog=!1,t.$message({message:"修改成功",type:"success"}),t.getList()}))}))},showShipping:function(t){this.shipping_detail_dialog=!0,this.shipping_detail.company=t.t_express_company,this.shipping_detail.shipping_no=t.t_express_code,this.shipping_detail.express_time=t.t_express_time,this.shipping_detail.express_note=t.t_express_note}}},p=n,d=(i("dac8"),i("2877")),c=Object(d["a"])(p,a,o,!1,null,null,null);e["default"]=c.exports},"9c7b":function(t,e,i){},dac8:function(t,e,i){"use strict";var a=i("9c7b"),o=i.n(a);o.a}}]);
//# sourceMappingURL=order.f21d505b.js.map